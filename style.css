/* === 1. 전체 설정 및 변수 === */
@import url('https://fonts.googleapis.com/css2?family=Stick&display=swap');
@import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

:root { 
    --font-main: 'Pretendard', sans-serif; 
    --font-sub: 'Apple SD Gothic Neo', sans-serif; 
    --font-title: 'Stick', sans-serif; 
    --color-bg: #ffffff; 
    --color-text-primary: #222222; 
    --color-text-secondary: #888888; 
    --color-border: #e0e0e0; 
    --color-black: #000000; 
}

/* ▼▼▼ [핵심] 반응형 비율 제어 (Ratio Control) ▼▼▼ */
html {
    /* [공식 설명]
       1. 16px: 14인치(약 1500px 너비)에서의 기준 크기 (작업하신 원본 비율)
       2. 0.6vw + 7px: 화면이 넓어질 때 아주 완만하게 커짐
       3. 19px: 27인치(약 2560px 너비)에서도 이 이상 커지지 않도록 제한 (Limit)
       
       => 결과: 화면이 2배 커져도, 버튼과 글자는 약 1.2배 정도만 세련되게 커집니다.
    */
    font-size: clamp(16px, 0.6vw + 7px, 19px);
}

body { 
    margin: 0; font-family: var(--font-main); 
    background-color: var(--color-bg); color: var(--color-text-primary); 
    overflow: hidden; 
}

#intro-container {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: var(--color-bg); z-index: 1000;
    transition: opacity 0.8s ease-in-out;
}

#intro-container.hidden { opacity: 0; pointer-events: none; }

.logo-container {
    position: absolute; top: 50%; left: 50%;
    transform: translate(-50%, -50%); text-align: center;
}

.logo-text {
    font-family: var(--font-title);
    /* 로고는 타이틀이므로 임팩트 있게(3rem ~ 5.5rem 제한) */
    font-size: clamp(3rem, 7vw, 5.5rem);
    font-weight: 400; color: var(--color-text-primary);
    line-height: 1.1; min-height: 1.1em; margin: 0;
}

.logo-text .dud { opacity: 0.3; }

#startBtn { 
    position: absolute; bottom: 12%; left: 50%; 
    transform: translateX(-50%); 
}

@font-face { font-family: 'Apple SD Gothic Neo'; font-weight: 500; font-style: normal; font-display: swap; src: url('https://cdn.jsdelivr.net/gh/fonts-archive/AppleSDGothicNeo/AppleSDGothicNeo-Medium.woff2') format('woff2'), url('https://cdn.jsdelivr.net/gh/fonts-archive/AppleSDGothicNeo/AppleSDGothicNeo-Medium.ttf') format('truetype'); }

/* === 2. 버튼 공통 스타일 (비율 유지 핵심: rem 단위 사용) === */
.btn { 
    /* px 대신 rem을 사용하여 폰트 크기가 커질 때 버튼 크기(여백)도 비례해서 커짐 */
    padding: 0.9rem 1.8rem; 
    font-size: 1rem; /* html font-size 기준 (16px~19px) */
    background: var(--color-bg); color: var(--color-black); 
    border: 0.06rem solid #ddd; /* 테두리 두께도 미세하게 반응형 */
    border-radius: 0.5rem; 
    cursor: pointer; transition: all 0.2s ease; 
    font-family: var(--font-sub); font-weight: 500; 
}
.btn:hover { background-color: #f5f5f5; transform: translateY(-0.15rem); }
.btn:disabled { cursor: not-allowed; background-color: #f9f9f9; color: #aaa; }
#retryBtn { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10000; }

/* === 3. 스크립트 텍스트 영역 === */
#script-columns { display: flex; width: 100%; height: 100vh; position: absolute; top: 0; left: 0; }
.column { 
    width: 33.33%; height: 100%; overflow-y: scroll; 
    padding: 2.5rem; /* 여백도 반응형 */
    font-size: 5rem; line-height: 1.8; white-space: pre-wrap; box-sizing: border-box; 
    border-right: 0.06rem solid var(--color-border); 
}
.column:last-child { border-right: none; }
.column::-webkit-scrollbar { width: 0.25rem; }
.column::-webkit-scrollbar-thumb { background-color: #bbb; border-radius: 0.12rem; }

/* === 4. 재조합 문장 시각화 === */
#sentence-container { 
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
    max-width: 80vw; padding: 1.5rem; text-align: center; 
    font-size: 2.2rem; /* 타이틀급 텍스트라 큼 */
    line-height: 1.8; white-space: pre-wrap; z-index: 20; 
}
.container { display: flex; justify-content: center; flex-wrap: wrap; margin-bottom: 0.5rem; }
.blur { animation: blur-text 1.2s ease-in-out forwards; font-weight: 800; margin: 0.25rem 0.5rem; }
@keyframes blur-text { 0% { filter: blur(0.25rem); opacity: .6; } 100% { filter: blur(0); opacity: 1; } }
.text { margin: 0.25rem 0.5rem; font-weight: 200; }
.dud  { opacity: .5; }

/* === 5. 음성 인식 UI 및 애니메이션 === */
#listening-ui { 
    position: fixed; bottom: 8%; left: 50%; transform: translateX(-50%); 
    display: flex; flex-direction: column; align-items: center; gap: 1.25rem; z-index: 200; 
}
#listening-ui .circle-container { 
    width: 5rem; height: 5rem; /* 80px -> 5rem */
    position: relative; display: flex; justify-content: center; align-items: center; 
}
#listening-ui #statusText { 
    font-family: var(--font-sub); 
    font-weight: 500; 
    font-size: 1rem; /* 본문 크기와 동일하게 맞춤 */
    color: var(--color-text-secondary); 
    white-space: nowrap; 
    min-height: 1.2em; 
}
#listening-ui .ring { position: absolute; border-radius: 50%; background-color: var(--color-black); }
#circle {
    width: 1.25rem; height: 1.25rem;
    animation-name: breathingWave; animation-iteration-count: infinite;
    animation-duration: 2.2s; animation-timing-function: ease-in-out; 
    transition: animation-duration 0.5s ease-in-out;
}
#circle.is-listening { animation-duration: 1.0s; }
@keyframes breathingWave { 
  0%, 100% { width: 1.25rem; height: 1.25rem; opacity: 1; } 
  50% { width: 3.75rem; height: 3.75rem; opacity: 0.85; } 
}

/* === 6. 오버레이/유틸 === */
#blur-overlay { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; backdrop-filter: blur(12px); background-color: rgba(0, 0, 0, 0.25); z-index: 9999; }
.hidden { display: none !important; }
#particleCanvas { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background-color: transparent; z-index: 45; pointer-events: none; transition: opacity 0.5s ease; }
#particleCanvas:not(.hidden) { opacity: 1; }

/* === 10. AI 추천 UI 스타일 === */
#inspiration-ui { 
    position: fixed; top: 45%; left: 50%; transform: translate(-50%, -50%); 
    width: 100%; max-width: 50rem; padding: 1.25rem; 
    box-sizing: border-box; display: flex; flex-direction: column; align-items: center; z-index: 100; 
}
.inspiration-header { text-align: center; margin-bottom: 2rem; }
.inspiration-header h1 { font-family: var(--font-main); font-size: 1.6rem; font-weight: 700; color: var(--color-text-primary); margin: 0 0 0.75rem 0; }
.inspiration-header p { font-family: var(--font-main); font-size: 1rem; font-weight: 400; color: var(--color-text-secondary); margin: 0; line-height: 1.5; }
.inspiration-chips { display: flex; justify-content: center; flex-wrap: wrap; gap: 0.75rem; }
.chip { 
    display: inline-block; padding: 0.6rem 1.2rem; 
    font-family: var(--font-sub); font-size: 1rem; 
    color: #888888; background-color: transparent; 
    border: 0.06rem solid #d0d0d0; border-radius: 3rem; 
    transition: all 0.2s ease; cursor: default; 
}
.chip:hover { border-color: #a0a0d0; color: var(--color-text-primary); }

/* ▼▼▼ 가이드 캡슐 (Pill) ▼▼▼ */
.guide-pill {
    position: fixed; top: 2rem; left: 50%; z-index: 100;
    padding: 0.75rem 1.5rem; /* 버튼과 비슷한 비율의 여백 */
    background-color: rgba(255, 255, 255, 0.85); backdrop-filter: blur(10px);
    border: 0.06rem solid rgba(0, 0, 0, 0.05); border-radius: 2rem; 
    box-shadow: 0 0.25rem 1.25rem rgba(0, 0, 0, 0.06);
    font-family: var(--font-main); 
    font-size: 1.1rem; /* 약간 강조 */
    font-weight: 500; color: #444444; text-align: center; white-space: nowrap;
}

/* === 11. 답변 유도 안내문 스타일 === */
.response-guides-container { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: flex; flex-direction: row; gap: 25vw; z-index: 200; transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
.text-guide { 
    font-size: 2rem; /* 버튼보다 훨씬 커야 함 */
    font-weight: 700; color: var(--color-text-secondary); 
    animation: pulse-text 3s infinite ease-in-out; 
    cursor: pointer; transition: color 0.2s ease, transform 0.2s ease; 
}
.text-guide:nth-child(2) { animation-delay: -1.5s; }
.text-guide:hover { color: var(--color-text-primary); transform: scale(1.05); }
@keyframes pulse-text { 0%, 100% { transform: scale(1); opacity: 0.7; } 50% { transform: scale(1.05); opacity: 1; } }
.re-prompt-guide { pointer-events: none; opacity: 0; transform: translate(-50%, 0) scale(0.95); transition: opacity 0.5s ease-out, transform 0.5s ease-out; }
.re-prompt-guide.visible { opacity: 1; transform: translate(-50%, 0) scale(1); }

/* === 12. 에피소드 선택 화면 (책) === */
#episode-selection-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; opacity: 1; transition: opacity 0.5s ease; background-color: var(--color-bg); z-index: 50; }
.info-text { transform: translateX(-50%); }
#viewport { width: 100vw; height: 100vh; overflow: hidden; cursor: grab; position: relative; }
#stage { position: absolute; width: 300vw; height: 300vh; left: 0; top: 0; transform-origin: 0 0; }

/* 책 크기 반응형 설정 */
.book { 
    position: absolute; 
    /* 15.6rem * 16px = 약 250px (기존 크기) -> 화면 커지면 같이 커짐 */
    width: 15.6rem; height: 21.9rem; 
    background-color: #ffffff; border: 0.06rem solid var(--color-border); border-radius: 0.5rem; 
    box-shadow: 0 0.3rem 1.25rem rgba(0, 0, 0, 0.07); padding: 1.5rem; box-sizing: border-box; 
    display: flex; flex-direction: column; justify-content: flex-end; 
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; cursor: pointer; 
}
.book:hover { transform: translateY(-0.6rem) scale(1.05); box-shadow: 0 0.6rem 1.8rem rgba(0, 0, 0, 0.1); }
.book h2 { font-size: 1.8rem; margin: 0 0 0.3rem 0; text-align: left; }
.book p { font-size: 1rem; color: var(--color-text-secondary); margin: 0; text-align: left; }

#episode-tooltip {
    position: fixed; width: 18.75rem;
    background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
    border: 0.06rem solid rgba(0, 0, 0, 0.1); border-radius: 0.75rem;
    box-shadow: 0 0.5rem 1.8rem rgba(0, 0, 0, 0.12); padding: 1.25rem; box-sizing: border-box;
    z-index: 100; opacity: 0; transform: translateY(0.6rem);
    transition: opacity 0.3s ease, transform 0.3s ease; pointer-events: none;
}
#episode-tooltip.visible { opacity: 1; transform: translateY(0); }
#tooltip-title { font-size: 1.2rem; font-weight: 600; margin: 0 0 0.5rem 0; color: var(--color-text-primary); }
#tooltip-description { font-size: 0.9rem; line-height: 1.6; color: #444; margin: 0; }

/* === 13. 스크립트 뷰 스타일 === */
#script-view { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.7); z-index: 40; display: flex; justify-content: center; align-items: center; pointer-events: none; opacity: 0; transition: opacity 0.5s ease; }
#script-view:not(.hidden) { pointer-events: auto; }
.script-content-wrapper {
    width: 60vw; height: 75vh; 
    max-width: 40rem; /* 너무 넓어지지 않게 제한 */
    background-color: var(--color-bg); border: 0.06rem solid var(--color-border);
    border-radius: 0.75rem; box-shadow: 0 0.5rem 1.8rem rgba(0, 0, 0, 0.08);
    overflow-y: auto; padding: 2.5rem; box-sizing: border-box;
}
.script-content-wrapper::-webkit-scrollbar { width: 0.25rem; }
.script-content-wrapper::-webkit-scrollbar-track { background: transparent; }
.script-content-wrapper::-webkit-scrollbar-thumb { background: #ccc; border-radius: 0.12rem; }
.script-content { width: 100%; }
#script-body { width: 100%; font-size: 1.4rem; line-height: 2.2; color: var(--color-text-primary); text-align: center; }
#script-body .line { white-space: pre-wrap; word-break: keep-all; opacity: 1; transition: opacity 0.4s ease, color 0.4s ease, transform 0.4s ease; }
#script-body.playing .line { opacity: 0.35; color: #aaa; }
#script-body.playing .line.active { opacity: 1; color: var(--color-text-primary); transform: scale(1.01); }
#close-button {
    position: fixed; top: 2rem; right: 2.5rem;
    font-size: 3rem; background: none; border: none;
    color: var(--color-text-secondary); cursor: pointer;
    transition: transform 0.2s ease; z-index: 210; pointer-events: auto;
}
#close-button:hover { transform: scale(1.1); }

/* === 14. 힌트 스낵바 스타일 === */
#hint-snackbar {
    position: fixed; z-index: 2000; top: 2rem; right: 2rem;
    background-color: var(--color-bg, #fff); border: 0.06rem solid var(--color-border, #e0e0e0);
    border-radius: 0.6rem; box-shadow: 0 0.3rem 1.25rem rgba(0, 0, 0, 0.08);
    display: flex; align-items: center; padding: 0.75rem 1.1rem;
    width: auto; max-width: 26rem;
    font-family: var(--font-sub, 'Apple SD Gothic Neo'); font-weight: 500;
    font-size: 0.9rem; color: var(--color-text-primary, #222);
    visibility: hidden; opacity: 0; transform: translateX(100%);
    transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.5s cubic-bezier(0.23, 1, 0.32, 1), visibility 0.5s;
}
#hint-snackbar.show { visibility: visible; opacity: 1; transform: translateX(0); }
.snackbar-icon {
    display: grid; place-items: center; flex-shrink: 0;
    width: 1.25rem; height: 1.25rem; margin-right: 0.75rem;
    border-radius: 50%; background-color: var(--color-border, #e0e0e0);
    color: var(--color-text-secondary, #888); font-size: 0.9rem;
    font-weight: 700; line-height: 1; font-family: 'Times New Roman', Times, serif;
}
#snackbar-text { line-height: 1.5; }